<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <base href="/" />	  
    <title>Pengmaradi.GitHub.io</title>
    <link rel="stylesheet" href="stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/metisMenu.min.css">
    <link rel="stylesheet" href="stylesheets/sb-admin-2.css">
    <link rel="stylesheet" href="stylesheets/morris.css">
    <link rel="stylesheet" href="stylesheets/styles.css">

  </head>
  <body>

    <div id="wrapper">
	  

<nav>
    
    <a href="/" >
        Home
    </a>
    
    <a href="/news.html" >
        Blog
    </a>
    
    <a href="/profile.html" >
        About
    </a>
    
</nav>


<button class="test" @click="toggleDarkmode()">Toggle Dark Mode</button>

     
      
	<div id="page-wrapper">
		<h1 id="typo3-command-line-change-tx_templavoila_flex-to-custom_ext">TYPO3 Command Line change tx_templavoila_flex to custom_ext</h1>

<h2 id="accordion-command-controllerphp">Accordion Command Controller.php</h2>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">Vendor\BiozentrumAccordion\Command</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">\TYPO3\CMS\Core\Utility\GeneralUtility</span><span class="p">;</span>

<span class="cd">/**
 * class AccordionCommandController
 *
 */</span>
<span class="kd">class</span> <span class="nc">AccordionCommandController</span> <span class="kd">extends</span> <span class="nc">\TYPO3\CMS\Extbase\Mvc\Controller\CommandController</span>
<span class="p">{</span>
	<span class="cd">/**
	 * php typo3/cli_dispatch.phpsh extbase biozentrum_accordion:accordion:accordion --dry-run=1
	 * Migrate default content Templavoilà objects to default textpic elements
	 *
	 * @param integer $templavoilaObjectId
	 * @param boolean $dryRun Dry run
	 * @return void
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="n">accordionCommand</span><span class="p">(</span><span class="nv">$templavoilaObjectId</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nv">$dryRun</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="nv">$where</span> <span class="o">=</span> <span class="s1">' '</span><span class="p">;</span>
		<span class="c1">//$where .= 'AND uid = 4587';</span>
		
		<span class="nv">$res</span> <span class="o">=</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">'TYPO3_DB'</span><span class="p">]</span><span class="o">-&gt;</span><span class="nf">exec_SELECTgetRows</span><span class="p">(</span>
			<span class="s1">'uid,pid, tstamp,crdate,ExtractValue(tx_templavoila_flex, \'T3FlexForms/data/sheet/language/field[@index="field_inhalt"]/value[@index="vDEF"]\') as bodytext, ExtractValue(tx_templavoila_flex, \'T3FlexForms/data/sheet/language/field[@index="field_title"]/value\') as subheader, sys_language_uid,l18n_parent,\'biozentrumaccordion_accordion\' as CType'</span><span class="p">,</span> 
			<span class="s1">'tt_content'</span><span class="p">,</span> 
			<span class="s1">'tx_templavoila_ds = '</span> <span class="mf">.</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$templavoilaObjectId</span><span class="p">)</span> <span class="mf">.</span> <span class="s1">' AND tx_templavoila_to = 11'</span><span class="mf">.</span> <span class="nv">$where</span><span class="p">,</span> 
			<span class="s1">''</span><span class="p">,</span> 
			<span class="s1">'l18n_parent ASC'</span>
		<span class="p">);</span>
		
		
		
		<span class="k">foreach</span><span class="p">(</span><span class="nv">$res</span> <span class="k">as</span> <span class="nv">$index</span> <span class="o">=&gt;</span> <span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$result</span><span class="p">[</span><span class="s1">'uid'</span><span class="p">];</span>
			<span class="nv">$result</span><span class="p">[</span><span class="s1">'bodytext'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">htmlspecialchars_decode</span><span class="p">(</span><span class="nv">$result</span><span class="p">[</span><span class="s1">'bodytext'</span><span class="p">]);</span>
			<span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">updateContent</span><span class="p">(</span><span class="nv">$uid</span><span class="p">,</span> <span class="nv">$result</span><span class="p">,</span> <span class="nv">$dryRun</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * 
	 * @param integer $uid
	 * @param array $result
	 * @param boolean $dryRun
	 */</span>
	<span class="k">private</span> <span class="k">function</span> <span class="n">updateContent</span><span class="p">(</span><span class="nv">$uid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$result</span><span class="p">,</span> <span class="nv">$dryRun</span><span class="p">)</span> <span class="p">{</span>
		<span class="nv">$updateWhere</span> <span class="o">=</span> <span class="s1">'uid = '</span> <span class="mf">.</span> <span class="nv">$uid</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$dryRun</span><span class="p">)</span> <span class="p">{</span>
			<span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">'TYPO3_DB'</span><span class="p">]</span><span class="o">-&gt;</span><span class="nf">exec_UPDATEquery</span><span class="p">(</span>
				<span class="s1">'tt_content'</span><span class="p">,</span> <span class="nv">$updateWhere</span><span class="p">,</span> <span class="nv">$result</span>
			<span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">echo</span> <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">'TYPO3_DB'</span><span class="p">]</span><span class="o">-&gt;</span><span class="nf">UPDATEquery</span><span class="p">(</span>
				<span class="s1">'tt_content'</span><span class="p">,</span> <span class="nv">$updateWhere</span><span class="p">,</span> <span class="nv">$result</span>
			<span class="p">),</span><span class="s1">';'</span><span class="p">,</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="ext_localconfphp">ext_localconf.php</h2>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">'TYPO3_CONF_VARS'</span><span class="p">][</span><span class="s1">'SC_OPTIONS'</span><span class="p">][</span><span class="s1">'extbase'</span><span class="p">][</span><span class="s1">'commandControllers'</span><span class="p">][]</span> <span class="o">=</span> <span class="s1">'Vendor\\BiozentrumAccordion\\Command\\AccordionCommandController'</span><span class="p">;</span>

</code></pre></div></div>


	 </div>
   	  
    </div>
    
<div class="container">
    <i>Layout ist default</i>
    <p>31 August 2024</p>
    <p>© pengmaradi 2024</p>
</div>



  </body>
</html>
